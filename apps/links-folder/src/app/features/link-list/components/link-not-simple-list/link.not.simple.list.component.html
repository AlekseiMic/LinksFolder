<ng-template #folderList let-dir>
  <div class="subdirectory">
    <input type="checkbox" [name]="dir" [checked]="isOpen(dir)" (change)="onDirChecked($event, dir)" />
    <button (click)="isExpanded(dir) ? collapse(dir) : expand(dir)">
      {{ isExpanded(dir) ? '<' : '>' }}
    </button>
    <button (click)="toggle(dir)">
      {{ dir }}
      {{ getFolder(dir)?.name ?? 'unknown' }}
    </button>
    <button (click)="createSubdir(dir)">Subdir</button>
    <button>Edit</button>
    <ng-template
      *ngIf="isExpanded(dir)"
      ngFor
      [ngForOf]="getSubfolders(dir)"
      [ngForTemplate]="folderList"
    >
    </ng-template>
  </div>
</ng-template>

<ng-template #linkList let-links>
  <div class="item" *ngFor="let link of links">
    <a href="{{ link.url }}" target="_blank">{{ link.text ?? link.url }}</a>
    <div class="actions">
      <button class="edit" btn (click)="edit(link.directory, link.id)">
        <svg-icon name="gear-icon"></svg-icon>
      </button>
      <button class="delete" btn (click)="delete(link.directory, link.id)">
        <svg-icon name="trash-icon"></svg-icon>
      </button>
    </div>
  </div>
</ng-template>

<div class="layout">
  <div class="left-panel">
    <ng-template
      [ngTemplateOutlet]="folderList"
      [ngTemplateOutletContext]="{ $implicit: directory }"
    >
    </ng-template>
  </div>
  <div class="right-panel">
    <app-link-form
      [directory]="openned"
      [showDescription]="false"
    ></app-link-form>
    <div *ngIf="lists" class="list">
      <ng-template
        [ngTemplateOutlet]="linkList"
        [ngTemplateOutletContext]="{ $implicit: links }"
      >
      </ng-template>
    </div>
  </div>
</div>
